!function(a){function b(a){return a instanceof Array?{latitude:a[0],longitude:a[1]}:a}var c,d,e={type:"shortest",transportMode:"car",options:"",trafficMode:"default",width:4,color:"#ff6347",marker:{text:"#",textColor:"#fff"},zoomTo:!0};d=function(d,f,g,h){var i,j,k,l;c=c||nokia.maps,d=b(d),f=b(f),g instanceof Array?h=a.extend({},e,h):(h=a.extend({},e,g),g=[]),k=function(b,d,e){var f,g,i,j,k,l={};"finished"===e?(f=b.getRoutes(),j=f[0],i=new c.map.Polyline(j&&j.shape,{pen:new c.util.Pen({lineWidth:h.width,strokeColor:h.color})}),g=new c.map.Container,g.objects.add(i),a.each(j.waypoints,a.proxy(function(b,c){var d=a.extend({},h.marker);"#"===h.marker.text&&(d.text=b+1),this.marker(c.originalPosition,d)},this)),this.map.objects.add(g),h.zoomTo&&this.map.zoomTo(g.getBoundingBox(),!1,"default"),l.time=j.summary.travelTime,l.length=j.summary.distance,l.waypoints=j.waypoints,l.legs=j.legs,"function"==typeof h.onroute&&h.onroute.call(this.element,l),k=a.Event("jhere.route",{route:l,target:this.element}),a(this.element).trigger(k)):"failed"===e&&a.error("Failed to calculate route")},i=new c.routing.Manager,i.addObserver("state",a.proxy(k,this)),j=new c.routing.WaypointParameterList,j.addCoordinate(d),a.each(g,function(a,c){j.addCoordinate(b(c))}),j.addCoordinate(f),l={transportModes:[h.transportMode],type:h.type,options:h.options,trafficMode:h.trafficMode},i.calculateRoute(j,[l])},a.jHERE.extend("route",d)}(jQuery);